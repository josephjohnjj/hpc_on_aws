---
- name: Install OpenPBS dependencies on all nodes
  hosts: all
  become: yes
  tasks:


    - name: Clean all DNF caches
      ansible.builtin.shell: dnf clean all
      args:
        executable: /bin/bash
      tags: dnf

    - name: Rebuild DNF cache
      ansible.builtin.shell: dnf makecache
      args:
        executable: /bin/bash
      tags: dnf

    - name: Reboot nodes
      reboot:
        reboot_timeout: 600
        test_command: whoami


    - name: Install required packages
      ansible.builtin.dnf:
        name:
          - libedit-devel
          - libical-devel
          - ncurses-devel
          - rpm-build
          - libtool
          - libX11-devel
          - libXt-devel
          - libXext
          - libXext-devel
          - libXmu-devel
          - tcl-devel
          - tk-devel
          - postgresql-devel
          - postgresql-server
          - postgresql-contrib
          - expat-devel
          - openssl-devel
          - hwloc-devel
          - java-21-openjdk-devel
          - cjson-devel
          - swig
          - swig-doc
          - sendmail
        state: present
        update_cache: yes
      tags: packages

    
